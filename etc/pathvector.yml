# FloofOS BGP Configuration (Pathvector)
# Documentation: https://pathvector.io/docs/configuration
#
# Steps: 1. Set ASN/router-id  2. Add prefixes  3. Configure peers  4. commit
#
# BGP Large Communities (YOUR_ASN:function:value):
#   65000:1:0 - Originated locally (your prefixes)
#   65000:1:1 - Learned from upstream
#   65000:1:2 - Learned from route server
#   65000:1:3 - Learned from peer
#   65000:1:4 - Learned from downstream
#   65000:1:5 - Learned from iBGP

asn: 65000
router-id: 0.0.0.0

prefixes:
  - 192.0.2.0/24
  - 2001:db8::/32
local-communities:
  - 65000:1:0

default-route: false
accept-default: false
merge-paths: true

bgpq-args: "-S AFRINIC,APNIC,ARIN,LACNIC,RIPE"
irr-server: rr.ntt.net
irr-query-timeout: 30

rtr-server: rtr.rpki.cloudflare.com:8282

#peeringdb-api-key: "your-api-key-here"
#peeringdb-query-timeout: 30

kernel:
  learn: true

templates:
  upstream:
    local-pref: 100
    add-on-import:
      - 65000:1:1
    announce:
      - 65000:1:0
      - 65000:1:4
    filter-rpki: true
    filter-bogon-routes: true
    filter-bogon-asns: true
    import-limit4: 1500000
    import-limit6: 300000
    allow-local-as: true
    remove-all-communities: 65000

  routeserver:
    local-pref: 200
    add-on-import:
      - 65000:1:2
    announce:
      - 65000:1:0
      - 65000:1:4
    filter-rpki: true
    filter-transit-asns: true
    filter-bogon-routes: true
    filter-bogon-asns: true
    auto-import-limits: true
    enforce-first-as: false
    enforce-peer-nexthop: false
    remove-all-communities: 65000

  peer:
    local-pref: 300
    add-on-import:
      - 65000:1:3
    announce:
      - 65000:1:0
      - 65000:1:4
    filter-rpki: true
    filter-irr: true
    filter-transit-asns: true
    filter-bogon-routes: true
    filter-bogon-asns: true
    auto-as-set: true
    auto-import-limits: true
    remove-all-communities: 65000

  downstream:
    local-pref: 400
    add-on-import:
      - 65000:1:4
    announce:
      - 65000:1:0
      - 65000:1:1
      - 65000:1:2
      - 65000:1:3
    filter-rpki: true
    filter-irr: true
    filter-transit-asns: true
    filter-bogon-routes: true
    filter-bogon-asns: true
    auto-as-set: true
    auto-import-limits: true
    allow-blackhole-community: true
    remove-all-communities: 65000

  ibgp:
    local-pref: 150
    add-on-import:
      - 65000:1:5
    announce:
      - 65000:1:0
      - 65000:1:1
      - 65000:1:2
      - 65000:1:3
      - 65000:1:4
      - 65000:1:5
    next-hop-self: true
    direct: true
    allow-local-as: true
    enforce-first-as: false
    enforce-peer-nexthop: false
    filter-irr: false
    filter-rpki: false
    remove-all-communities: 65000
#    rr-client: true

#-------------------------------------------------------------------
# PEERS CONFIGURATION
# Uncomment and modify the examples below
#-------------------------------------------------------------------
#
#peers:
#
### Transit/Upstream Provider
#  Cogent:
#    template: upstream
#    asn: 174
#    neighbors:
#      - 154.54.x.x
#    password: "secret"
#
### IXP Route Server
#  DE-CIX_RS:
#    template: routeserver
#    asn: 6695
#    neighbors:
#      - 80.81.192.157
#      - 80.81.192.158
#
### Bilateral Peering or PNI (private network interconnection)
#  Cloudflare:
#    template: peer
#    asn: 13335
#    neighbors:
#      - 192.0.2.1
#
### Customer/Downstream
#  Customer_ABC:
#    template: downstream
#    asn: 64512
#    as-set: AS:AS-SET-CUSTOMER
#    neighbors:
#      - 192.0.2.10
#
### Internal BGP
#  Router2:
#    template: ibgp
#    asn: 65000
#    listen4: 10.255.0.1
#    neighbors:
#      - 10.255.0.2
#    multihop: 2

#-------------------------------------------------------------------
# OPTIONAL: Static default route for traceroute
# Uncomment if needed (preference 80 = lower than BGP)
#-------------------------------------------------------------------
#
#global-config: |
#  protocol static default_route {
#    ipv4 { preference 80; };
#    ipv6 { preference 80; };
#    route 0.0.0.0/0 via YOUR_GATEWAY_IPV4;
#    route ::/0 via YOUR_GATEWAY_IPV6;
#  }
